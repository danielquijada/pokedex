<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
    <title>Práctica de Reconocimiento del Habla</title>
</head>
<body>
    <h2>Práctica de Reconocimiento del Habla</h2>
    <section>
        <textarea id="areaResult"></textarea>
        <textarea id="finalTranscript"></textarea>
        <img id=mic src="img/logo.png"/>
    </section>
    <script>

      var recognition = new webkitSpeechRecognition();
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.lang = "es-ES";

      mic.addEventListener('click', function () {
        console.log("DENTRO");
        areaResult.focus();
        recognition.start();
      });

      //events

      recognition.onaudiostart = function (event) {
          console.log("onaudiostart");
      };

      recognition.onsoundstart = function (event) {
          console.log("onsoundstart");
      };

      recognition.onspeechstart = function (event) {
          console.log("onspeechstart");
      };

      recognition.onspeechend = function (event) {
          console.log("onspeechend");
      };

      recognition.onsoundend = function (event) {
          console.log("onsoundend");

      };

      recognition.onaudioend = function (event) {
          console.log("onaudioend");

      };

      recognition.onresult = function (event) {
          console.log("onresult");
          var interimResult = '',
              finalResult = '';
          for (var i = event.resultIndex; i < event.results.length; ++i) {
              if (event.results[i].isFinal) {
                  finalResult = event.results[i][0].transcript;
              } else {
                  interimResult += event.results[i][0].transcript;
              }
          }

          finalTranscript.value = finalResult;
          areaResult.value = interimResult;

          if (interimResult.indexOf('cerrar') == 1 || interimResult.indexOf('cerrar') == 0)
              recognition.stop();
      };

      recognition.onnomatch = function (event) {
          console.log("onnomatch");
      };

      recognition.onerror = function (event) {
          console.log("onerror: " + event);
          console.log(event);
      };

      recognition.onstart = function (event) {
          console.log("onstart");
      };

      recognition.onend = function (event) {
          console.log("onend");
      };
    </script>
</body>
</html>
